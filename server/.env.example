# NABD Server Environment Variables
# Copy this file to .env and fill in your values
# NEVER commit .env files with real values

# =============================================================================
# REQUIRED
# =============================================================================

# Database connection (PostgreSQL)
# For local development with Docker, use:
DATABASE_URL="postgresql://nabd:nabd_dev@localhost:5432/nabd_chain"

# For remote databases (Render, Supabase, etc.), use their connection string:
# DATABASE_URL="postgresql://user:password@host:port/database?sslmode=require"

# Server port
PORT=3001

# =============================================================================
# AUTHENTICATION
# =============================================================================

# Clerk authentication (get from https://dashboard.clerk.com)
CLERK_SECRET_KEY=sk_test_your_secret_key_here
CLERK_PUBLISHABLE_KEY=pk_test_your_publishable_key_here

# Allow dev tokens for local testing (SECURITY: must be false in production!)
# Only set to true in local development - NEVER in staging or production
# ALLOW_DEV_TOKENS=true

# =============================================================================
# SECURITY
# =============================================================================

# Encryption key for sensitive data (64 character hex string)
# Generate with: openssl rand -hex 32
ENCRYPTION_KEY=your_64_character_hex_encryption_key_here

# =============================================================================
# OAUTH PROVIDERS (for email integration)
# =============================================================================

# Google OAuth (get from https://console.cloud.google.com)
GOOGLE_CLIENT_ID=your_google_client_id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_REDIRECT_URI=http://localhost:3001/api/auth/google/callback

# Microsoft/Outlook OAuth (get from https://portal.azure.com)
OUTLOOK_CLIENT_ID=your_outlook_client_id
OUTLOOK_CLIENT_SECRET=your_outlook_client_secret
OUTLOOK_REDIRECT_URI=http://localhost:3001/api/auth/outlook/callback

# =============================================================================
# AI FEATURES (optional)
# =============================================================================

# Google Gemini API key (get from https://makersuite.google.com/app/apikey)
# NOTE: This should ONLY be in server/.env, never in frontend
GEMINI_API_KEY=your_gemini_api_key_here

# =============================================================================
# CORS & FRONTEND
# =============================================================================

# Frontend URL (for CORS and redirects)
FRONTEND_URL=http://localhost:5173
CORS_ORIGIN=http://localhost:5173

# =============================================================================
# PORTAL AUTHENTICATION (JWT)
# =============================================================================

# JWT secret for portal authentication (required in production)
# Generate with: openssl rand -base64 64
PORTAL_JWT_SECRET=your_portal_jwt_secret_here

# JWT issuer and audience (optional, defaults provided)
# PORTAL_JWT_ISSUER=nabd-portal
# PORTAL_JWT_AUDIENCE=nabd-portal-users

# Allow legacy x-user-id header authentication (for migration period only)
# Set to false once all clients have migrated to JWT
# ALLOW_LEGACY_PORTAL_AUTH=true

# Allow seed endpoint for creating initial admin user (development only)
# Never enable in production!
# PORTAL_ALLOW_SEED_ENDPOINT=true

# =============================================================================
# BACKGROUND JOBS (Development)
# =============================================================================

# By default, workers/scheduler are DISABLED in development and ENABLED in production.
# Set these to 'true' to enable them in development:

# Master switch for all background workers
# ENABLE_WORKERS=true

# Enable cron scheduler (scheduled jobs)
# ENABLE_SCHEDULER=true

# Granular worker controls (require ENABLE_WORKERS=true):
# ENABLE_EVENT_OUTBOX_WORKER=true    # Webhook delivery worker
# ENABLE_JOB_QUEUE_WORKER=true       # Async job processing worker
# ENABLE_OUTBOX=true                 # Legacy alias for ENABLE_EVENT_OUTBOX_WORKER

# Worker backoff configuration (milliseconds)
# WORKER_BACKOFF_MS=5000             # Initial backoff when DB is down
# WORKER_MAX_BACKOFF_MS=60000        # Maximum backoff delay

# Circuit breaker configuration
# CIRCUIT_FAILURE_THRESHOLD=3        # Failures before circuit opens
# CIRCUIT_RESET_TIMEOUT_MS=60000     # Time before circuit attempts to close

# =============================================================================
# PRODUCTION ONLY
# =============================================================================

# Set NODE_ENV=production in production
# NODE_ENV=production
