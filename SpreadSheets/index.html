<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>SpreadSheets</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

    <!-- React & ReactDOM (UMD) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel Standalone -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    colors: {
                        // Softer black branding (Zinc 700 instead of pure black)
                        brand: {
                            dark: '#3f3f46', // zinc-700
                            medium: '#52525b', // zinc-600
                            light: '#f4f4f5', // zinc-100
                        }
                    }
                },
            },
        }
    </script>
    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #f4f4f5;
        }

        ::-webkit-scrollbar-thumb {
            background: #d4d4d8;
            border-radius: 5px;
            border: 2px solid #f4f4f5;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a1a1aa;
        }

        /* Softer focus ring */
        .spreadsheet-cell:focus-within {
            outline: 2px solid #3f3f46;
            z-index: 10;
        }

        .sticky-corner {
            position: sticky;
            top: 0;
            left: 0;
            z-index: 40;
        }

        .sticky-col-header {
            position: sticky;
            top: 0;
            z-index: 20;
        }

        .sticky-row-header {
            position: sticky;
            left: 0;
            z-index: 30;
        }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
    <link rel="stylesheet" href="/index.css">
</head>

<body class="bg-white text-gray-800 font-display overflow-hidden h-screen flex flex-col">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- CONSTANTS ---
        const COLS = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P'];
        const NUM_ROWS = 50;

        // Removed mock data, starting empty
        const INITIAL_DATA = {};

        // --- COMPONENTS ---

        const Header = () => {
            return (
                <header className="flex items-center justify-between whitespace-nowrap border-b border-solid border-gray-200 bg-white px-4 py-2 shrink-0 z-50">
                    <div className="flex items-center gap-4">
                        <div className="size-8 flex items-center justify-center text-brand-dark">
                            <span className="material-symbols-outlined text-[32px]">table_chart</span>
                        </div>
                        <div>
                            <div className="flex items-center gap-2">
                                <h1 className="text-gray-800 text-lg font-bold leading-tight">Untitled Spreadsheet</h1>
                                <span className="material-symbols-outlined text-gray-400 text-lg cursor-pointer hover:text-brand-dark transition-colors">star</span>
                                <span className="material-symbols-outlined text-gray-400 text-lg cursor-pointer hover:text-brand-dark transition-colors">drive_file_move</span>
                                <span className="material-symbols-outlined text-gray-400 text-lg cursor-pointer hover:text-brand-dark transition-colors">cloud_done</span>
                            </div>
                            <div className="flex gap-1 mt-1">
                                {['File', 'Edit', 'View', 'Insert', 'Format', 'Data', 'Tools', 'Extensions', 'Help'].map((item) => (
                                    <button key={item} className="px-2 py-0.5 text-sm text-gray-600 hover:bg-gray-100 rounded transition-colors">
                                        {item}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>

                    <div className="flex items-center gap-4">
                        <button className="p-2 hover:bg-gray-100 rounded-full text-gray-600 transition-colors">
                            <span className="material-symbols-outlined text-[24px]">history</span>
                        </button>
                        <button className="p-2 hover:bg-gray-100 rounded-full text-gray-600 transition-colors">
                            <span className="material-symbols-outlined text-[24px]">comment</span>
                        </button>
                        <button className="p-2 hover:bg-gray-100 rounded-full text-gray-600 transition-colors">
                            <span className="material-symbols-outlined text-[24px]">videocam</span>
                        </button>
                        <button className="flex items-center justify-center rounded-full h-9 px-6 bg-brand-dark text-white text-sm font-bold gap-2 hover:bg-gray-600 transition-colors">
                            <span className="material-symbols-outlined text-[18px]">lock</span>
                            <span>Share</span>
                        </button>
                        <div
                            className="bg-center bg-no-repeat bg-cover rounded-full size-9 border border-gray-200 bg-gray-100 flex items-center justify-center"
                        >
                            <span className="material-symbols-outlined text-gray-400">person</span>
                        </div>
                    </div>
                </header>
            );
        };

        const Divider = () => <div className="w-[1px] h-5 bg-gray-300 mx-1"></div>;

        const IconButton = ({ icon, active = false }) => (
            <button
                className={`p-1 rounded transition-colors ${active ? 'bg-gray-200 text-brand-dark' : 'text-gray-600 hover:bg-gray-100'}`}
            >
                <span className="material-symbols-outlined text-[18px]">{icon}</span>
            </button>
        );

        const Toolbar = () => {
            return (
                <div className="flex flex-col shrink-0 bg-[#f9fafb] border-b border-gray-200">
                    <div className="flex items-center gap-1 px-4 py-1.5 overflow-x-auto no-scrollbar">
                        <div className="flex gap-0.5 items-center pr-2 border-r border-gray-300">
                            <IconButton icon="undo" />
                            <IconButton icon="redo" />
                            <IconButton icon="print" />
                            <IconButton icon="format_paint" />
                        </div>

                        <div className="flex gap-0.5 items-center px-2 border-r border-gray-300">
                            <button className="flex items-center gap-1 p-1 px-2 text-gray-600 hover:bg-gray-100 rounded text-sm font-medium">
                                100% <span className="material-symbols-outlined text-[16px]">arrow_drop_down</span>
                            </button>
                        </div>

                        <div className="flex gap-0.5 items-center px-2 border-r border-gray-300">
                            <IconButton icon="attach_money" />
                            <IconButton icon="percent" />
                            <IconButton icon="decimal_decrease" />
                            <IconButton icon="decimal_increase" />
                        </div>

                        <div className="flex gap-0.5 items-center px-2 border-r border-gray-300">
                            <button className="flex items-center gap-6 p-1 px-2 text-gray-600 hover:bg-gray-100 rounded text-sm font-medium w-32 justify-between">
                                Inter <span className="material-symbols-outlined text-[16px]">arrow_drop_down</span>
                            </button>
                            <Divider />
                            <IconButton icon="remove" />
                            <input
                                className="w-8 text-center text-sm bg-transparent border-none p-0 focus:ring-0 text-gray-800"
                                type="text"
                                defaultValue="10"
                            />
                            <IconButton icon="add" />
                        </div>

                        <div className="flex gap-0.5 items-center px-2 border-r border-gray-300">
                            <IconButton icon="format_bold" active />
                            <IconButton icon="format_italic" />
                            <IconButton icon="format_strikethrough" />

                            <button className="p-1 text-gray-600 hover:bg-gray-100 rounded flex flex-col items-center justify-center gap-0.5">
                                <span className="material-symbols-outlined text-[18px]">format_color_text</span>
                                <div className="w-4 h-1 bg-brand-dark"></div>
                            </button>

                            <button className="p-1 text-gray-600 hover:bg-gray-100 rounded flex flex-col items-center justify-center gap-0.5">
                                <span className="material-symbols-outlined text-[18px]">format_color_fill</span>
                                <div className="w-4 h-1 bg-white border border-gray-300"></div>
                            </button>
                        </div>

                        <div className="flex gap-0.5 items-center px-2">
                            <IconButton icon="border_all" />
                            <IconButton icon="merge_type" />
                            <IconButton icon="format_align_left" />
                            <IconButton icon="vertical_align_center" />
                            <IconButton icon="wrap_text" />
                            <IconButton icon="filter_alt" />
                            <IconButton icon="functions" />
                        </div>
                    </div>
                </div>
            );
        };

        const FormulaBar = ({ selectedCell, value }) => {
            return (
                <div className="flex items-center gap-0 px-2 py-1 bg-white border-b border-gray-200 h-10">
                    <div className="relative group flex items-center h-full">
                        <input
                            className="w-20 px-2 py-1 text-sm font-medium text-center border-none focus:ring-1 focus:ring-brand-dark rounded hover:bg-gray-50 bg-transparent text-gray-600"
                            type="text"
                            value={selectedCell}
                            readOnly
                        />
                        <div className="w-[1px] h-4 bg-gray-300 mx-2"></div>
                    </div>

                    <button className="px-3 text-gray-400 hover:text-brand-dark font-serif italic font-bold text-lg flex items-center justify-center h-full transition-colors">
                        fx
                    </button>
                    <div className="w-[1px] h-6 bg-gray-300 mx-1"></div>

                    <input
                        className="flex-1 px-2 py-1 text-sm text-gray-800 border-none focus:ring-0 placeholder:text-gray-400 font-display h-full"
                        placeholder="Enter text or formula"
                        type="text"
                        value={value}
                        readOnly
                    />
                </div>
            );
        };

        const Grid = ({ data, selectedCell, onSelectCell }) => {
            const getCellId = (col, row) => `${col}${row}`;

            return (
                <main className="flex-1 overflow-auto bg-[#f4f4f5] relative">
                    <table className="w-full border-collapse bg-white text-sm table-fixed">
                        <thead>
                            <tr>
                                <th className="sticky-corner bg-gray-50 border-r border-b border-gray-300 w-[46px] min-w-[46px] h-[28px] z-50"></th>
                                {COLS.map((col) => {
                                    const isSelectedCol = selectedCell.col === col;
                                    return (
                                        <th
                                            key={col}
                                            className={`sticky-col-header border-r border-b border-gray-300 w-[100px] font-bold text-center select-none 
                                                ${isSelectedCol ? 'bg-brand-dark text-white border-brand-dark' : 'bg-gray-50 text-gray-600'}
                                            `}
                                        >
                                            {col}
                                        </th>
                                    );
                                })}
                            </tr>
                        </thead>
                        <tbody>
                            {Array.from({ length: NUM_ROWS }, (_, i) => i + 1).map((row) => {
                                const isSelectedRow = selectedCell.row === row;
                                return (
                                    <tr key={row} className="h-[28px]">
                                        <td
                                            className={`sticky-row-header border-r border-b border-gray-300 text-center font-medium text-xs select-none
                                                ${isSelectedRow ? 'bg-brand-dark text-white border-brand-dark' : 'bg-gray-50 text-gray-600'}
                                            `}
                                        >
                                            {row}
                                        </td>
                                        {COLS.map((col) => {
                                            const cellId = getCellId(col, row);
                                            const cellData = data[cellId];
                                            const isSelected = selectedCell.col === col && selectedCell.row === row;
                                            const isInSelectedRowOrCol = selectedCell.col === col || selectedCell.row === row;

                                            // Fallback handling if no style provided
                                            const style = cellData?.style || {};
                                            const alignClass = style.align === 'right' ? 'text-right' : style.align === 'center' ? 'text-center' : 'text-left';
                                            const boldClass = style.bold ? 'font-bold' : '';
                                            const italicClass = style.italic ? 'italic' : '';
                                            // Subtle highlight for row/col sharing cells
                                            const bgClass = style.bg || (isInSelectedRowOrCol && !isSelected ? 'bg-gray-50' : 'bg-white');
                                            const colorClass = style.color || 'text-gray-900';

                                            return (
                                                <td
                                                    key={cellId}
                                                    onClick={() => onSelectCell(col, row)}
                                                    className={`
                                                        border-r border-b border-gray-200 px-1 outline-none cursor-cell relative
                                                        ${alignClass} ${boldClass} ${italicClass} ${bgClass} ${colorClass}
                                                        ${isSelected ? 'spreadsheet-cell-selected ring-2 ring-brand-dark z-10' : ''}
                                                    `}
                                                >
                                                    {cellData?.displayValue || cellData?.value || ''}
                                                    {isSelected && (
                                                        <div className="absolute bottom-[-4px] right-[-4px] w-2 h-2 bg-brand-dark border border-white cursor-crosshair z-20"></div>
                                                    )}
                                                </td>
                                            );
                                        })}
                                    </tr>
                                );
                            })}
                        </tbody>
                    </table>
                </main>
            );
        };

        const Footer = () => {
            return (
                <footer className="flex items-center justify-between px-2 bg-white border-t border-gray-200 shrink-0 h-10 select-none">
                    <div className="flex items-center h-full">
                        <button className="p-1.5 hover:bg-gray-100 rounded text-gray-600">
                            <span className="material-symbols-outlined text-[20px]">add</span>
                        </button>
                        <button className="p-1.5 hover:bg-gray-100 rounded text-gray-600 mr-2">
                            <span className="material-symbols-outlined text-[20px]">menu</span>
                        </button>

                        <div className="flex items-end h-full">
                            <div className="flex items-center px-4 h-9 bg-white text-brand-dark font-bold text-sm border-b-2 border-brand-dark hover:bg-gray-50 cursor-pointer">
                                Sheet1
                                <span className="material-symbols-outlined text-[16px] ml-1">arrow_drop_down</span>
                            </div>
                            <div className="flex items-center px-4 h-9 text-gray-600 text-sm hover:bg-gray-100 cursor-pointer border-b-2 border-transparent">
                                Sheet2
                            </div>
                        </div>
                    </div>

                    <div className="flex items-center gap-4">
                        <div className="h-4 w-[1px] bg-gray-300"></div>
                        <button className="flex items-center gap-1.5 px-3 py-1 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded transition-colors group">
                            <span className="material-symbols-outlined text-[18px] text-gray-500 group-hover:text-brand-dark transition-colors">colors_spark</span>
                            Explore
                        </button>
                    </div>
                </footer>
            );
        };

        const App = () => {
            const [selectedCell, setSelectedCell] = useState({ col: 'D', row: 2 });
            const [data] = useState(INITIAL_DATA);

            const currentCellId = `${selectedCell.col}${selectedCell.row}`;
            const currentCellValue = data[currentCellId]?.value || '';

            return (
                <div className="flex flex-col h-screen w-full bg-white text-gray-900">
                    <Header />
                    <Toolbar />
                    <FormulaBar
                        selectedCell={currentCellId}
                        value={currentCellValue}
                    />
                    <Grid
                        data={data}
                        selectedCell={selectedCell}
                        onSelectCell={(col, row) => setSelectedCell({ col, row })}
                    />
                    <Footer />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
    <script type="module" src="/index.tsx"></script>
</body>

</html>